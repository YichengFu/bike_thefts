---
title: "Understanding Bicycle Theft in High-Risk Neighborhoods: Key Predictors for Targeted Risk Assessment"
subtitle: "An Analysis of Theft Patterns and Risk Factors in Toronto's High-Theft Areas"
author: 
  - Tommy Fu
thanks: "Code and data are available at: https://github.com/YichengFu/bike_thefts_analysis.git."
date: today
date-format: long
toc: true
abstract: "This study explores patterns of bicycle theft in Toronto, focusing on thefts in high-risk neighborhoods using logistic regression. The analysis identifies bike cost, premises type, location type, and time of occurrence as significant predictors of thefts in high-risk neighborhoods. Results show that high-cost bikes are disproportionately stolen in public spaces and during evening hours, with specific neighborhoods exhibiting elevated theft rates. These findings highlight risk factors and provide actionable insights for targeted interventions, urban planning, and improved security measures in vulnerable areas."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(knitr)
library(arrow)
library(here)
library(rstanarm)
library(modelsummary)



raw_data <- read_csv(here::here("data/01-raw_data/Bicycle_Thefts_Open_Data.csv"))
analysis_data <- read_parquet(here::here("data/02-analysis_data/analysis_data.parquet"))
```


# Introduction

## Overview
Bicycle theft is a persistent urban problem with significant economic and emotional impacts on individuals and communities. In cities like Toronto, where cycling plays an increasingly vital role in promoting sustainable transportation, understanding the factors contributing to bicycle theft is essential for designing effective preventive measures. While previous studies have examined general theft trends, few have focused specifically on identifying patterns in high-risk neighborhoods, where targeted interventions could have the greatest impact. In this paper the bike thefts data from Toronto Police Open Data will be utilized . This paper seeks to address this gap by exploring the spatial, temporal, and contextual factors associated with bicycle thefts in Toronto.

## Estimand 
The estimand of this study is the likelihood of thefts occurring in high-risk neighborhoods compared to others, given key predictors such as bike cost, premises type, location type, and time of theft. The estimand focuses on understanding the characteristics of thefts in these neighborhoods, allowing us to identify significant factors that differentiate high-risk areas from others. By using a logistic regression model, the analysis aims to quantify these relationships and provide actionable insights.

## Results Summary
The analysis highlights significant relationships between theft occurrences in high-risk neighborhoods and predictors such as bike cost, premises type, and time of day. Findings suggest that high-cost bicycles are frequently targeted in public spaces during evening hours, with some neighborhoods experiencing disproportionately higher theft rates.

## Why this paper matters
This research provides actionable knowledge to enhance theft prevention in urban settings. By identifying the circumstances under which thefts are more likely to occur, the study offers evidence to inform targeted interventions, such as improved security measures in vulnerable areas. These findings contribute to creating safer urban spaces for cyclists.

## Paper Structure: 
The remainder of this paper is structured as follows. In @sec-data, the overview of the data used in this study and the variables of interests will be introduced. Further the data normalization will be discussed in details. @sec-model illustrates the Bayesian logistic regression model built in our analysis, some details include model set up, assumptions and justification. @sec-result highlights the result of the model visualizing using tables and graphs. Lastly, @sec-discussion contains discussion of the analysis based on findings, the limitations of the model and the suggestion for future research. 

# Data {#sec-data}

## Overview

Our data is sourced from Toronto Police Open Data[@toronto_bicycle_thefts] specifically on the bike thefts dataset which captures details in bike thefts reported in Great Toronto Area. The bike thefts dataset including details about the bicycles, such as cost, make, and type, as well as information about the thefts, such as the date, time, location type, premises type, and neighborhood. Geospatial data, including latitude and longitude, is also included to allow for spatial analysis. A sample of the data variables can be find @tbl-rawdatalist in the appendix. 


## Measurement
	This study uses data from Torontoâ€™s open data portal, which provides detailed records of bicycle theft incidents across the city. The dataset includes key variables related to theft characteristics, location details, and bike attributes, allowing for a comprehensive analysis of theft patterns in high-risk neighborhoods. The dataset focuses exclusively on stolen bicycles, making it well-suited for examining the spatial and contextual factors influencing thefts. While other datasets, such as police crime reports or neighborhood demographic data, could provide additional context, they were not used due to limited accessibility or lack of detailed bike-specific information.
Some paragraphs about how we go from a phenomena in the world to an entry in the dataset.
## Data Processing
## Outcome variables
## Predictor Variable

Add graphs, tables and text. Use sub-sub-headings for each outcome variable or update the subheading to be singular.


```{r}
#| label: fig-bills
#| fig-cap: Bills of penguins
#| echo: false

#ggplot(penguins, aes(x = island, fill = species)) +
  #geom_bar(alpha = 0.8) +
  #scale_fill_manual(values = c("darkorange","purple","cyan4"),
                 #   guide = "none") +
  #theme_minimal() +
  #facet_wrap(~species, ncol = 1) +
  #coord_flip()
```

Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)

```{r}
#| label: fig-planes
#| fig-cap: Relationship between wing length and width
#| echo: false
#| warning: false
#| message: false

#analysis_data <- read_csv(here::here("data/02-analysis_data/analysis_data.csv"))

#analysis_data |> 
  #ggplot(aes(x = width, y = length)) +
  #geom_point(alpha = 0.8) +
  #theme_minimal() +
  #labs(x = "Wing width (mm)",
   #    y = "Wing length (mm)")
```

Talk way more about it. 

## Predictor variables

Add graphs, tables and text.

Use sub-sub-headings for each outcome variable and feel free to combine a few into one if they go together naturally.








# Model {#sec-model}

The goal of our modelling strategy is twofold. Firstly,...

Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up

Define $y_i$ as the number of seconds that the plane remained aloft. Then $\beta_i$ is the wing width and $\gamma_i$ is the wing length, both measured in millimeters.  

\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results {#sec-result}

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

library(rstanarm)

first_model <-
  readRDS(file = here::here("models/first_model.rds"))
```

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

modelsummary::modelsummary(
  list(
    "First model" = first_model
  ),
  statistic = "mad",
  fmt = 2
)
```




# Discussion {#sec-discussion}

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

## Raw data variables
```{r}
#| echo: false
#| eval: true
#| label: tbl-rawdatalist
#| tbl-cap: "The list of variables and a sample value from the raw data"
#| warning: false
#### Create Variable List with Sample Values ####
variable_list <- tibble(
  `Variable Name` = names(raw_data),
  `Sample Value` = sapply(raw_data[1, ], as.character) # Extract the first row as sample values
)

#### Display the Table in Appendix ####
variable_list %>%
  kable(
    format = "markdown",
    caption = "List of Variables in the Raw Dataset with Sample Values"
  )

```




# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

#pp_check(first_model) +
 #theme_classic() +
 # theme(legend.position = "bottom")


#posterior_vs_prior(first_model) +
#  theme_minimal() +
#  scale_color_brewer(palette = "Set1") +
 # theme(legend.position = "bottom") +
 # coord_flip()
```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2

plot(first_model, "trace")

plot(first_model, "rhat")
```



\newpage


# References


